-----------------------------------------------
----------- 2 cores & 12 instances ------------
-----------------------------------------------




-----------------------------------------------
----------- Sample size: 100 MB ---------------
-----------------------------------------------


23/05/03 22:04:17 INFO org.apache.spark.SparkEnv: Registering MapOutputTracker
23/05/03 22:04:17 INFO org.apache.spark.SparkEnv: Registering BlockManagerMaster
23/05/03 22:04:17 INFO org.apache.spark.SparkEnv: Registering BlockManagerMasterHeartbeat
23/05/03 22:04:17 INFO org.apache.spark.SparkEnv: Registering OutputCommitCoordinator
23/05/03 22:04:17 INFO org.sparkproject.jetty.util.log: Logging initialized @5866ms to org.sparkproject.jetty.util.log.Slf4jLog
23/05/03 22:04:17 INFO org.sparkproject.jetty.server.Server: jetty-9.4.40.v20210413; built: 2021-04-13T20:42:42.668Z; git: b881a572662e1943a14ae12e7e1207989f218b74; jvm 1.8.0_362-b09
23/05/03 22:04:17 INFO org.sparkproject.jetty.server.Server: Started @6056ms
23/05/03 22:04:17 INFO org.sparkproject.jetty.server.AbstractConnector: Started ServerConnector@4bdae800{HTTP/1.1, (http/1.1)}{0.0.0.0:42021}
23/05/03 22:04:18 INFO org.apache.hadoop.yarn.client.AHSProxy: Connecting to Application History server at cluster-51ad-m-0.us-central1-c.c.egd-project.internal./10.128.0.15:10200
23/05/03 22:04:19 INFO org.apache.hadoop.yarn.client.ConfiguredRMFailoverProxyProvider: Failing over to rm1
23/05/03 22:04:19 INFO org.apache.hadoop.io.retry.RetryInvocationHandler: java.net.ConnectException: Call From cluster-51ad-m-1/10.128.0.17 to cluster-51ad-m-1.us-central1-c.c.egd-project.internal.:8032 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused, while invoking ApplicationClientProtocolPBClientImpl.getNewApplication over rm1 after 1 failover attempts. Trying to failover after sleeping for 1434ms.
23/05/03 22:04:20 INFO org.apache.hadoop.yarn.client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
23/05/03 22:04:21 INFO org.apache.hadoop.conf.Configuration: resource-types.xml not found
23/05/03 22:04:21 INFO org.apache.hadoop.yarn.util.resource.ResourceUtils: Unable to find 'resource-types.xml'.
23/05/03 22:04:22 INFO org.apache.hadoop.yarn.client.api.impl.YarnClientImpl: Submitted application application_1683146037328_0004
23/05/03 22:04:23 INFO org.apache.hadoop.yarn.client.ConfiguredRMFailoverProxyProvider: Failing over to rm1
23/05/03 22:04:23 INFO org.apache.hadoop.io.retry.RetryInvocationHandler: java.net.ConnectException: Call From cluster-51ad-m-1/10.128.0.17 to cluster-51ad-m-1.us-central1-c.c.egd-project.internal.:8030 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused, while invoking ApplicationMasterProtocolPBClientImpl.registerApplicationMaster over rm1 after 1 failover attempts. Trying to failover after sleeping for 1453ms.
23/05/03 22:04:25 INFO org.apache.hadoop.yarn.client.ConfiguredRMFailoverProxyProvider: Failing over to rm2
23/05/03 22:04:27 INFO com.google.cloud.hadoop.repackaged.gcs.com.google.cloud.hadoop.gcsio.GoogleCloudStorageImpl: Ignoring exception of type GoogleJsonResponseException; verified object already exists with desired state.
23/05/03 22:04:49 WARN org.apache.spark.sql.catalyst.util.package: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
+----------+--------------------+--------------------+--------------------+-----+----+------------+-----+---------+---------+----+--------+------------+------------+----+-----+----+----+-----------+---------+-----------+------+-----+----+----+------------+
|        id|                 url|              region|          region_url|price|year|manufacturer|model|condition|cylinders|fuel|odometer|title_status|transmission| VIN|drive|size|type|paint_color|image_url|description|county|state| lat|long|posting_date|
+----------+--------------------+--------------------+--------------------+-----+----+------------+-----+---------+---------+----+--------+------------+------------+----+-----+----+----+-----------+---------+-----------+------+-----+----+----+------------+
|7222695916|https://prescott....|            prescott|https://prescott....| 6000|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   az|null|null|        null|
|7218891961|https://fayar.cra...|        fayetteville|https://fayar.cra...|11900|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   ar|null|null|        null|
|7221797935|https://keys.crai...|        florida keys|https://keys.crai...|21000|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   fl|null|null|        null|
|7222270760|https://worcester...|worcester / centr...|https://worcester...| 1500|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   ma|null|null|        null|
|7210384030|https://greensbor...|          greensboro|https://greensbor...| 4900|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   nc|null|null|        null|
|7222379453|https://hudsonval...|       hudson valley|https://hudsonval...| 1600|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   ny|null|null|        null|
|7221952215|https://hudsonval...|       hudson valley|https://hudsonval...| 1000|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   ny|null|null|        null|
|7220195662|https://hudsonval...|       hudson valley|https://hudsonval...|15995|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   ny|null|null|        null|
|7209064557|https://medford.c...|     medford-ashland|https://medford.c...| 5000|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   or|null|null|        null|
|7219485069|https://erie.crai...|                erie|https://erie.crai...| 3000|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   pa|null|null|        null|
|7218893038|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   tx|null|null|        null|
|7218325704|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   tx|null|null|        null|
|7217788283|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   tx|null|null|        null|
|7217147606|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   tx|null|null|        null|
|7209027818|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   tx|null|null|        null|
|7223509794|https://bellingha...|          bellingham|https://bellingha...|13995|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   wa|null|null|        null|
|7222753076|https://bellingha...|          bellingham|https://bellingha...|24999|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   wa|null|null|        null|
|7222206015|https://bellingha...|          bellingham|https://bellingha...|21850|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   wa|null|null|        null|
|7220030122|https://bellingha...|          bellingham|https://bellingha...|26850|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   wa|null|null|        null|
|7218423006|https://bellingha...|          bellingham|https://bellingha...|11999|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   wa|null|null|        null|
+----------+--------------------+--------------------+--------------------+-----+----+------------+-----+---------+---------+----+--------+------------+------------+----+-----+----+----+-----------+---------+-----------+------+-----+----+----+------------+
only showing top 20 rows

+----------+--------------------+-------------+--------------------+-----+----+------------+--------------------+---------+-----------+-----+--------+------------+------------+-----------------+-----+----+------+-----------+--------------------+--------------------+------+-----+-----+------+--------------------+
|        id|                 url|       region|          region_url|price|year|manufacturer|               model|condition|  cylinders| fuel|odometer|title_status|transmission|              VIN|drive|size|  type|paint_color|           image_url|         description|county|state|  lat|  long|        posting_date|
+----------+--------------------+-------------+--------------------+-----+----+------------+--------------------+---------+-----------+-----+--------+------------+------------+-----------------+-----+----+------+-----------+--------------------+--------------------+------+-----+-----+------+--------------------+
|7220195662|https://hudsonval...|hudson valley|https://hudsonval...|15995|null|        null|                null|     null|       null| null|    null|        null|        null|             null| null|null|  null|       null|                null|                null|  null|   ny| null|  null|                null|
|7222753076|https://bellingha...|   bellingham|https://bellingha...|24999|null|        null|                null|     null|       null| null|    null|        null|        null|             null| null|null|  null|       null|                null|                null|  null|   wa| null|  null|                null|
|7313857701|https://auburn.cr...|       auburn|https://auburn.cr...|25590|2015|         gmc|sierra 1500 regul...|     good|6 cylinders|other|   35290|       clean|       other|1GTN1TEH9FZ243281| null|null|pickup|      white|https://images.cr...|Carvana is the sa...|  null|   al|32.59|-85.48|2021-04-28T11:01:...|
|7312824400|https://auburn.cr...|       auburn|https://auburn.cr...|32990|2019|   chevrolet|   silverado 1500 ld|     good|       null|other|    6897|       clean|       other|2GCVKNEC8K1187169| null|null|pickup|      black|https://images.cr...|Carvana is the sa...|  null|   al|32.59|-85.48|2021-04-26T10:41:...|
|7312313815|https://auburn.cr...|       auburn|https://auburn.cr...|33990|2017|        jeep|wrangler unlimite...|     good|6 cylinders|other|   34152|       clean|       other|1C4HJWEG5HL696454|  4wd|null|   SUV|      white|https://images.cr...|Carvana is the sa...|  null|   al|32.59|-85.48|2021-04-25T09:41:...|
|7311351407|https://auburn.cr...|       auburn|https://auburn.cr...|33990|2020|        jeep|wrangler sport su...|     good|6 cylinders|  gas|    9859|       clean|       other|1C4GJXAG9LW193038|  4wd|null| other|       null|https://images.cr...|Carvana is the sa...|  null|   al|32.59|-85.48|2021-04-23T10:10:...|
|7310332383|https://auburn.cr...|       auburn|https://auburn.cr...|36990|2019|       volvo|s60 t6 inscriptio...|     good|       null|  gas|    8141|       clean|       other|7JRA22TL6KG004114| null|null| sedan|      white|https://images.cr...|Carvana is the sa...|  null|   al|32.59|-85.48|2021-04-21T10:11:...|
|7310276274|https://auburn.cr...|       auburn|https://auburn.cr...|28590|2019|       volvo|s60 t5 momentum s...|     good|       null|  gas|   18531|       clean|       other|7JR102FK4KG010003|  fwd|null| sedan|      black|https://images.cr...|Carvana is the sa...|  null|   al|32.59|-85.48|2021-04-21T08:30:...|
|7308730136|https://auburn.cr...|       auburn|https://auburn.cr...|40590|2019|        ford|f250 super duty r...|     good|8 cylinders|other|    9313|       clean|       other|1FTBF2B65KEC91136|  4wd|null|pickup|      white|https://images.cr...|Carvana is the sa...|  null|   al|32.59|-85.48|2021-04-18T09:50:...|
|7308216849|https://auburn.cr...|       auburn|https://auburn.cr...|39590|2018|        jeep|wrangler unlimite...|     good|6 cylinders|  gas|   21893|       clean|       other|1C4HJXEGXJW175675|  4wd|null|   SUV|     silver|https://images.cr...|Carvana is the sa...|  null|   al|32.59|-85.48|2021-04-17T09:21:...|
+----------+--------------------+-------------+--------------------+-----+----+------------+--------------------+---------+-----------+-----+--------+------------+------------+-----------------+-----+----+------+-----------+--------------------+--------------------+------+-----+-----+------+--------------------+
only showing top 10 rows



-----------------------------------------------
------------- Queries Testing -----------------
-----------------------------------------------


-----------------------------------------------
----------------- Query 1 ---------------------
-----------------------------------------------

What's the average price and total number of listings for each car manufacturer?

+-------------+------------------+------------+
| manufacturer|        avg(price)|num_listings|
+-------------+------------------+------------+
|         ford|19226.799215686275|        5100|
|    chevrolet| 48579.29180084221|        4037|
|       toyota|16084.602295211713|        2527|
|        honda| 11078.38471587198|        1531|
|       nissan|11281.739376770538|        1412|
|         jeep| 1074081.491766467|        1336|
|          ram| 26673.30273141123|        1318|
|          gmc|  22816.6647819063|        1238|
|          bmw|18563.857416267943|        1045|
|        dodge|13958.977317554241|        1014|
|mercedes-benz|19705.805385556916|         817|
|      hyundai|10512.573426573426|         715|
|       subaru| 13180.32667617689|         701|
|   volkswagen|12979.717125382263|         654|
|          kia|11215.587542087542|         594|
|        lexus| 19308.85025817556|         581|
|         audi| 23441.10786106033|         547|
|     cadillac|19791.952848722987|         509|
|     chrysler|  9985.56570155902|         449|
|        buick|14379.178997613366|         419|
+-------------+------------------+------------+
only showing top 20 rows

-----------------------------------------------
----------------- Query 2 ---------------------
-----------------------------------------------

What is the average price and sum of listings per state?

+--------------------+------------+------------+
|               state|num_listings|median_price|
+--------------------+------------+------------+
|                 ...|           1|     42908.0|
|                 ...|           1|     64995.0|
|                 ...|           1|     25495.0|
|                ABS.|           1|     23888.0|
|                S...|           1|     10681.0|
|             BLAC...|           1|      5977.0|
|             X 9&...|           1|     18995.0|
|          BROADWA...|           1|         0.0|
|            GVWR: 5.|           1|     38250.0|
|         PARKING ...|           1|     16350.0|
|       3.16 AXLE ...|           1|     18388.0|
|               SIDI.|           1|     26995.0|
|  BACKUP SENSORS....|           3|     38991.0|
|  DUAL REAR DVD P...|           3|     26998.0|
|  MN* 2011 FORD F...|           1|     27900.0|
| & MIRRORS. TOW M...|           1|     57913.0|
| & MIRRORS.   SAF...|           1|     14960.0|
|                 '11|           1|      7100.0|
|   (ALL WHEEL DRIVE)|           1|     12490.0|
| (RD5) 20"" POLIS...|           2|         0.0|
+--------------------+------------+------------+
only showing top 20 rows

-----------------------------------------------
----------------- Query 3 ---------------------
-----------------------------------------------

What percentage of postings for each state is salvaged cars?

+-----+----------+
|state|percentage|
+-----+----------+
|   ca|     21.17|
|   nc|      8.14|
|   tx|      7.49|
|   pa|      4.89|
|   nm|      4.89|
|   ia|      4.56|
|   sc|      3.91|
|   mi|      3.58|
|   mn|      3.26|
|   ny|      2.93|
|   az|      2.61|
|   wi|      2.28|
|   or|      2.28|
|   tn|      1.95|
|   nj|      1.63|
|   wa|      1.63|
|   ne|      1.63|
|   id|      1.63|
|   co|      1.63|
|   la|       1.3|
+-----+----------+
only showing top 20 rows

None
-----------------------------------------------
----------------- Results ---------------------
-----------------------------------------------
+--------------------+--------------+------------+-----------------+---------+
|   Cores & Instances|   Query/Model|Dataset size|   Execution Time|CPU Usage|
+--------------------+--------------+------------+-----------------+---------+
|2 cores & 12 inst...|Sample loading|         100|16.11558222770691|     32.7|
|2 cores & 12 inst...|       Query 1|         100|6.961515188217163|     36.8|
|2 cores & 12 inst...|       Query 2|         100|5.472331285476685|     33.0|
|2 cores & 12 inst...|       Query 3|         100|7.817259073257446|     35.0|
+--------------------+--------------+------------+-----------------+---------+



-----------------------------------------------
-------------- Models Testing -----------------
-----------------------------------------------


root
 |-- index: long (nullable = false)
 |-- price: string (nullable = true)
 |-- year: string (nullable = true)
 |-- manufacturer: string (nullable = true)
 |-- model: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- fuel: string (nullable = true)
 |-- odometer: string (nullable = true)
 |-- title_status: string (nullable = true)
 |-- transmission: string (nullable = true)
 |-- type: string (nullable = true)
 |-- posting_date: date (nullable = true)
 |-- age: double (nullable = true)
 |-- row_num: integer (nullable = true)

root
 |-- index: long (nullable = false)
 |-- price: string (nullable = true)
 |-- year: string (nullable = true)
 |-- manufacturer: string (nullable = true)
 |-- model: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- fuel: string (nullable = true)
 |-- odometer: string (nullable = true)
 |-- title_status: string (nullable = true)
 |-- transmission: string (nullable = true)
 |-- type: string (nullable = true)
 |-- age: double (nullable = true)

+-----+-----+----+------------+--------------------+---------+------+--------+------------+------------+-----------+----+
|index|price|year|manufacturer|               model|condition|  fuel|odometer|title_status|transmission|       type| age|
+-----+-----+----+------------+--------------------+---------+------+--------+------------+------------+-----------+----+
|    0|29777|2018|       volvo|           certified|excellent|   gas|   34040|       clean|   automatic|      sedan| 3.0|
|    1| 4500|2005|         bmw|                325i|excellent|   gas|  162030|       clean|      manual|      sedan|16.0|
|    2| 4000|2009|        ford|            focus se|excellent|   gas|     159|       clean|   automatic|convertible|12.0|
|    3|21900|2018|        ford|      taurus limited| like new|   gas|   44569|       clean|   automatic|      sedan| 3.0|
|    4|19995|2011|        ford|  e-450 delivery box| like new|   gas|  130935|       clean|   automatic|        van|10.0|
|    5| 6975|2009|      toyota|               camry|excellent|   gas|  161000|       clean|   automatic|      sedan|12.0|
|    6|12499|2014|     hyundai|          tucson gls|excellent|   gas|   54000|       clean|   automatic|        SUV| 7.0|
|    8|12988|2015|       honda|      civic lx sedan| like new|   gas|   93244|       clean|   automatic|      sedan| 6.0|
|    9|13995|2006|      toyota|              tacoma|excellent|   gas|  179979|       clean|   automatic|     pickup|15.0|
|   11|19999|2017|         kia|              optima| like new|hybrid|   33776|       clean|   automatic|      sedan| 4.0|
|   12|41999|2017|      toyota|     4runner trd pro|excellent|   gas|   58000|       clean|   automatic|        SUV| 4.0|
|   13|19995|2012|   chevrolet|      silverado 1500|excellent|   gas|   52824|       clean|   automatic|     pickup| 9.0|
|   14|15900|2016|      toyota|     camry hybrid se|excellent|hybrid|   70000|       clean|   automatic|      other| 5.0|
|   15| 6499|2012|        ford|            fiesta s|     good|   gas|   88891|       clean|   automatic|      sedan| 9.0|
|   18|28900|2014|         ram|       1500 crew cab|     good|diesel|  110854|       clean|   automatic|      truck| 7.0|
|   19| 5900|2005|        ford|       escape hybrid|excellent|   gas|   76265|       clean|   automatic|        SUV|16.0|
|   21|10999|2009|       lexus|              es 350|excellent|   gas|  142273|       clean|   automatic|      sedan|12.0|
|   22|18990|2013|         bmw|x5 xdrive35i premium|excellent|   gas|   78378|       clean|   automatic|        SUV| 8.0|
|   24| 8975|2004|         bmw|              745 li|excellent|   gas|   94900|       clean|   automatic|      sedan|17.0|
|   25|26310|2017|        ford|    f150 regular cab| like new|   gas|   97774|       clean|   automatic|     pickup| 4.0|
+-----+-----+----+------------+--------------------+---------+------+--------+------------+------------+-----------+----+
only showing top 20 rows

Categorical features: ['year', 'manufacturer', 'model', 'condition', 'fuel', 'title_status', 'transmission', 'type']


+-----+--------+----+----+------------+------+---------+----+------------+------------+----+
|price|odometer| age|year|manufacturer| model|condition|fuel|title_status|transmission|type|
+-----+--------+----+----+------------+------+---------+----+------------+------------+----+
|29777| 34040.0| 3.0| 8.0|        24.0| 229.0|      0.0| 0.0|         0.0|         0.0| 0.0|
| 4500|162030.0|16.0|13.0|         5.0| 601.0|      0.0| 0.0|         0.0|         1.0| 0.0|
| 4000|   159.0|12.0|11.0|         0.0|  60.0|      0.0| 0.0|         0.0|         0.0| 8.0|
|21900| 44569.0| 3.0| 8.0|         0.0| 414.0|      2.0| 0.0|         0.0|         0.0| 0.0|
|19995|130935.0|10.0| 5.0|         0.0|1430.0|      2.0| 0.0|         0.0|         0.0| 9.0|
| 6975|161000.0|12.0|11.0|         2.0|   3.0|      0.0| 0.0|         0.0|         0.0| 0.0|
|12499| 54000.0| 7.0| 1.0|        10.0| 581.0|      0.0| 0.0|         0.0|         0.0| 1.0|
|12988| 93244.0| 6.0| 2.0|         3.0|1320.0|      2.0| 0.0|         0.0|         0.0| 0.0|
|13995|179979.0|15.0|12.0|         2.0|   6.0|      0.0| 0.0|         0.0|         0.0| 3.0|
|19999| 33776.0| 4.0| 4.0|        14.0|  71.0|      2.0| 2.0|         0.0|         0.0| 0.0|
|41999| 58000.0| 4.0| 4.0|         2.0|1095.0|      0.0| 0.0|         0.0|         0.0| 1.0|
|19995| 52824.0| 9.0| 3.0|         1.0|   1.0|      0.0| 0.0|         0.0|         0.0| 3.0|
|15900| 70000.0| 5.0| 6.0|         2.0| 453.0|      0.0| 2.0|         0.0|         0.0|10.0|
| 6499| 88891.0| 9.0| 3.0|         0.0| 758.0|      1.0| 0.0|         0.0|         0.0| 0.0|
|28900|110854.0| 7.0| 1.0|         8.0| 593.0|      1.0| 1.0|         0.0|         0.0| 2.0|
| 5900| 76265.0|16.0|13.0|         0.0| 475.0|      0.0| 0.0|         0.0|         0.0| 1.0|
|10999|142273.0|12.0|11.0|        15.0|  69.0|      0.0| 0.0|         0.0|         0.0| 0.0|
|18990| 78378.0| 8.0| 0.0|         5.0|2390.0|      0.0| 0.0|         0.0|         0.0| 1.0|
| 8975| 94900.0|17.0|15.0|         5.0|1122.0|      0.0| 0.0|         0.0|         0.0| 0.0|
|26310| 97774.0| 4.0| 4.0|         0.0|1573.0|      2.0| 0.0|         0.0|         0.0| 3.0|
+-----+--------+----+----+------------+------+---------+----+------------+------------+----+
only showing top 20 rows

root
 |-- price: long (nullable = true)
 |-- odometer: double (nullable = true)
 |-- age: double (nullable = true)
 |-- year: double (nullable = false)
 |-- manufacturer: double (nullable = false)
 |-- model: double (nullable = false)
 |-- condition: double (nullable = false)
 |-- fuel: double (nullable = false)
 |-- title_status: double (nullable = false)
 |-- transmission: double (nullable = false)
 |-- type: double (nullable = false)


--- ML dataset ---

+-----+--------------------+
|price|            features|
+-----+--------------------+
| 5600|(10,[0,1,2,3,4],[...|
| 8795|(10,[0,1,3,4],[11...|
| 5800|[71600.0,16.0,13....|
|16800|[26000.0,5.0,6.0,...|
|12750|[87000.0,7.0,1.0,...|
+-----+--------------------+
only showing top 5 rows


--- Train Data ---

+-----+--------------------+
|price|            features|
+-----+--------------------+
| 2000|(10,[0,1,2,4,9],[...|
| 2000|[64000.0,17.0,15....|
| 2000|[111000.0,15.0,12...|
| 2000|[113142.0,12.0,11...|
| 2000|[139000.0,17.0,15...|
+-----+--------------------+
only showing top 5 rows


--- Test Data ---

+-----+--------------------+
|price|            features|
+-----+--------------------+
| 2000|(10,[0,1,2,3,4],[...|
| 2999|[124779.0,19.0,18...|
| 2999|[128714.0,18.0,16...|
| 3200|[154000.0,18.0,16...|
| 3450|[175000.0,19.0,18...|
+-----+--------------------+
only showing top 5 rows


--- Data Used for the Prediction---

+-----+--------------------+
|price|            features|
+-----+--------------------+
| 6695|(10,[0,1,3,4,5],[...|
| 7990|[102500.0,11.0,7....|
| 8995|[104000.0,11.0,7....|
|10900|(10,[0,1,3,4,9],[...|
|13600|[1900.0,1.0,19.0,...|
+-----+--------------------+
only showing top 5 rows

-----------------------------------------------
-------------- Linear Regression --------------
-----------------------------------------------
23/05/03 22:06:33 WARN com.github.fommil.netlib.BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeSystemBLAS
23/05/03 22:06:33 WARN com.github.fommil.netlib.BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeRefBLAS
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 0.05771
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.458869 (rel: 0.0823) 0.779150
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 0.5000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.320630 (rel: 0.301) 0.393662
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 0.5000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.281783 (rel: 0.121) 0.190033
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.269041 (rel: 0.0452) 0.0933903
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.265869 (rel: 0.0118) 0.0523051
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.263317 (rel: 0.00960) 0.0340719
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.262105 (rel: 0.00460) 0.0312449
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.261982 (rel: 0.000472) 0.0427155
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.261405 (rel: 0.00220) 0.00570533
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.261393 (rel: 4.64e-05) 0.00315095
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.261389 (rel: 1.43e-05) 0.00112450
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.261389 (rel: 2.49e-06) 0.000414865
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.261389 (rel: 2.24e-07) 3.08001e-05
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.261389 (rel: 1.40e-09) 7.49983e-06
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.261389 (rel: 1.19e-10) 1.76507e-06
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.261389 (rel: 6.46e-12) 4.51380e-07
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.261389 (rel: 2.50e-13) 8.97007e-08
23/05/03 22:06:34 INFO breeze.optimize.OWLQN: Converged because gradient converged

	--- Coefficient of Determination (R² & Adjusted R²) ---
R²		: 0.45009
Adjusted R²	: 0.45009

	--- Mean Squared Error (MSE & RMSE) ---
MSE	: 56702584.7417
RMSE	: 7530.11

	--- Mean Absolute Error (MAE) ---
MAE	: 5694.27

	--- Predictions ---
+-----+--------------------+------------------+
|price|            features|        prediction|
+-----+--------------------+------------------+
| 6695|(10,[0,1,3,4,5],[...|10488.031028942674|
| 7990|[102500.0,11.0,7....| 13526.73559956995|
| 8995|[104000.0,11.0,7....|11678.274861590642|
|10900|(10,[0,1,3,4,9],[...|  14342.7518533273|
|13600|[1900.0,1.0,19.0,...| 30310.07460055108|
+-----+--------------------+------------------+
only showing top 5 rows

-----------------------------------------------
---------------- Decision Tree ----------------
-----------------------------------------------
23/05/03 22:07:06 WARN org.apache.spark.ml.tree.impl.DecisionTreeMetadata: DecisionTree reducing maxBins from 40000 to 5736 (= number of training instances)

	--- Coefficient of Determination (R² & Adjusted R²) ---
R²		: -1.27905
Adjusted R²	: -1.27905

	--- Mean Squared Error (MSE & RMSE) ---
MSE	: 234999679.5759
RMSE	: 15329.70

	--- Mean Absolute Error (MAE) ---
MAE	: 9288.71

	--- Predictions ---
+-----+--------------------+------------------+
|price|            features|        prediction|
+-----+--------------------+------------------+
| 6695|(10,[0,1,3,4,5],[...| 9024.517777777777|
| 7990|[102500.0,11.0,7....|3856.9517045454545|
| 8995|[104000.0,11.0,7....| 6704.785365853659|
|10900|(10,[0,1,3,4,9],[...|           37295.0|
|13600|[1900.0,1.0,19.0,...|          16465.95|
+-----+--------------------+------------------+
only showing top 5 rows

-----------------------------------------------
--------- Random Forest Regression ------------
-----------------------------------------------
23/05/03 22:07:34 WARN org.apache.spark.ml.tree.impl.DecisionTreeMetadata: DecisionTree reducing maxBins from 40000 to 5736 (= number of training instances)

	--- Coefficient of Determination (R² & Adjusted R²) ---
R²		: 0.45127
Adjusted R²	: 0.45127

	--- Mean Squared Error (MSE & RMSE) ---
MSE	: 56581038.3510
RMSE	: 7522.04

	--- Mean Absolute Error (MAE) ---
MAE	: 5643.04

	--- Predictions ---
+-----+--------------------+------------------+
|price|            features|        prediction|
+-----+--------------------+------------------+
| 6695|(10,[0,1,3,4,5],[...| 9512.195456748297|
| 7990|[102500.0,11.0,7....| 9512.195456748297|
| 8995|[104000.0,11.0,7....| 9512.195456748297|
|10900|(10,[0,1,3,4,9],[...| 9512.195456748297|
|13600|[1900.0,1.0,19.0,...|16486.085573645367|
+-----+--------------------+------------------+
only showing top 5 rows

-----------------------------------------------
----------------- Results ---------------------
-----------------------------------------------
+---------+--------------------+------------+------------------+--------------------+
|CPU Usage|   Cores & Instances|Dataset size|    Execution Time|         Query/Model|
+---------+--------------------+------------+------------------+--------------------+
|     25.8|2 cores & 12 inst...|         100|37.280999183654785|    Liner Regression|
|     20.7|2 cores & 12 inst...|         100| 27.87275004386902|        Decison Tree|
|     17.1|2 cores & 12 inst...|         100|24.740081787109375|Random Forest Reg...|
+---------+--------------------+------------+------------------+--------------------+

+--------------------+--------------------+------------+------------------+---------+
|   Cores & Instances|         Query/Model|Dataset size|    Execution Time|CPU Usage|
+--------------------+--------------------+------------+------------------+---------+
|2 cores & 12 inst...|    Liner Regression|         100|37.280999183654785|     25.8|
|2 cores & 12 inst...|        Decison Tree|         100| 27.87275004386902|     20.7|
|2 cores & 12 inst...|Random Forest Reg...|         100|24.740081787109375|     17.1|
+--------------------+--------------------+------------+------------------+---------+



-----------------------------------------------
----------- Sample size: 700 MB ---------------
-----------------------------------------------


+----------+--------------------+--------------------+--------------------+-----+----+------------+-----+---------+---------+----+--------+------------+------------+----+-----+----+----+-----------+---------+-----------+------+-----+----+----+------------+
|        id|                 url|              region|          region_url|price|year|manufacturer|model|condition|cylinders|fuel|odometer|title_status|transmission| VIN|drive|size|type|paint_color|image_url|description|county|state| lat|long|posting_date|
+----------+--------------------+--------------------+--------------------+-----+----+------------+-----+---------+---------+----+--------+------------+------------+----+-----+----+----+-----------+---------+-----------+------+-----+----+----+------------+
|7222695916|https://prescott....|            prescott|https://prescott....| 6000|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   az|null|null|        null|
|7218891961|https://fayar.cra...|        fayetteville|https://fayar.cra...|11900|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   ar|null|null|        null|
|7221797935|https://keys.crai...|        florida keys|https://keys.crai...|21000|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   fl|null|null|        null|
|7222270760|https://worcester...|worcester / centr...|https://worcester...| 1500|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   ma|null|null|        null|
|7210384030|https://greensbor...|          greensboro|https://greensbor...| 4900|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   nc|null|null|        null|
|7222379453|https://hudsonval...|       hudson valley|https://hudsonval...| 1600|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   ny|null|null|        null|
|7221952215|https://hudsonval...|       hudson valley|https://hudsonval...| 1000|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   ny|null|null|        null|
|7220195662|https://hudsonval...|       hudson valley|https://hudsonval...|15995|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   ny|null|null|        null|
|7209064557|https://medford.c...|     medford-ashland|https://medford.c...| 5000|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   or|null|null|        null|
|7219485069|https://erie.crai...|                erie|https://erie.crai...| 3000|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   pa|null|null|        null|
|7218893038|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   tx|null|null|        null|
|7218325704|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   tx|null|null|        null|
|7217788283|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   tx|null|null|        null|
|7217147606|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   tx|null|null|        null|
|7209027818|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   tx|null|null|        null|
|7223509794|https://bellingha...|          bellingham|https://bellingha...|13995|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   wa|null|null|        null|
|7222753076|https://bellingha...|          bellingham|https://bellingha...|24999|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   wa|null|null|        null|
|7222206015|https://bellingha...|          bellingham|https://bellingha...|21850|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   wa|null|null|        null|
|7220030122|https://bellingha...|          bellingham|https://bellingha...|26850|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   wa|null|null|        null|
|7218423006|https://bellingha...|          bellingham|https://bellingha...|11999|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   wa|null|null|        null|
+----------+--------------------+--------------------+--------------------+-----+----+------------+-----+---------+---------+----+--------+------------+------------+----+-----+----+----+-----------+---------+-----------+------+-----+----+----+------------+
only showing top 20 rows

+----------+--------------------+--------------------+--------------------+-----+----+------------+--------------------+---------+-----------+----+--------+------------+------------+-----------------+-----+----+------+-----------+--------------------+--------------------+------+-----+-----+------+--------------------+
|        id|                 url|              region|          region_url|price|year|manufacturer|               model|condition|  cylinders|fuel|odometer|title_status|transmission|              VIN|drive|size|  type|paint_color|           image_url|         description|county|state|  lat|  long|        posting_date|
+----------+--------------------+--------------------+--------------------+-----+----+------------+--------------------+---------+-----------+----+--------+------------+------------+-----------------+-----+----+------+-----------+--------------------+--------------------+------+-----+-----+------+--------------------+
|7222270760|https://worcester...|worcester / centr...|https://worcester...| 1500|null|        null|                null|     null|       null|null|    null|        null|        null|             null| null|null|  null|       null|                null|                null|  null|   ma| null|  null|                null|
|7220195662|https://hudsonval...|       hudson valley|https://hudsonval...|15995|null|        null|                null|     null|       null|null|    null|        null|        null|             null| null|null|  null|       null|                null|                null|  null|   ny| null|  null|                null|
|7218893038|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null|                null|     null|       null|null|    null|        null|        null|             null| null|null|  null|       null|                null|                null|  null|   tx| null|  null|                null|
|7217788283|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null|                null|     null|       null|null|    null|        null|        null|             null| null|null|  null|       null|                null|                null|  null|   tx| null|  null|                null|
|7222753076|https://bellingha...|          bellingham|https://bellingha...|24999|null|        null|                null|     null|       null|null|    null|        null|        null|             null| null|null|  null|       null|                null|                null|  null|   wa| null|  null|                null|
|7220030122|https://bellingha...|          bellingham|https://bellingha...|26850|null|        null|                null|     null|       null|null|    null|        null|        null|             null| null|null|  null|       null|                null|                null|  null|   wa| null|  null|                null|
|7216672204|https://bellingha...|          bellingham|https://bellingha...|24999|null|        null|                null|     null|       null|null|    null|        null|        null|             null| null|null|  null|       null|                null|                null|  null|   wa| null|  null|                null|
|7212631321|https://skagit.cr...|skagit / island /...|https://skagit.cr...|21850|null|        null|                null|     null|       null|null|    null|        null|        null|             null| null|null|  null|       null|                null|                null|  null|   wa| null|  null|                null|
|7219973522|https://lacrosse....|           la crosse|https://lacrosse....|  500|null|        null|                null|     null|       null|null|    null|        null|        null|             null| null|null|  null|       null|                null|                null|  null|   wi| null|  null|                null|
|7316814884|https://auburn.cr...|              auburn|https://auburn.cr...|33590|2014|         gmc|sierra 1500 crew ...|     good|8 cylinders| gas|   57923|       clean|       other|3GTP1VEC4EG551563| null|null|pickup|      white|https://images.cr...|Carvana is the sa...|  null|   al|32.59|-85.48|2021-05-04T12:31:...|
+----------+--------------------+--------------------+--------------------+-----+----+------------+--------------------+---------+-----------+----+--------+------------+------------+-----------------+-----+----+------+-----------+--------------------+--------------------+------+-----+-----+------+--------------------+
only showing top 10 rows



-----------------------------------------------
------------- Queries Testing -----------------
-----------------------------------------------


-----------------------------------------------
----------------- Query 1 ---------------------
-----------------------------------------------

What's the average price and total number of listings for each car manufacturer?

+-------------+------------------+------------+
| manufacturer|        avg(price)|num_listings|
+-------------+------------------+------------+
|         ford| 22251.61245058188|       35918|
|    chevrolet| 94727.95663530001|       27949|
|       toyota|445982.04184172663|       17375|
|        honda|10779.771978274877|       10863|
|       nissan| 25500.25475751995|        9774|
|         jeep|277608.94576515385|        9717|
|          ram|28480.788060983465|        9314|
|          gmc|23099.122206539636|        8502|
|          bmw| 34075.08548734518|        7428|
|        dodge|15431.729675667953|        6999|
|mercedes-benz|1022640.4056697612|        6032|
|      hyundai| 10877.20730783794|        5282|
|       subaru|13147.055971702039|        4806|
|   volkswagen|12678.887486855941|        4755|
|          kia|11099.858133086876|        4328|
|        lexus| 19364.52720677146|        4135|
|         audi| 23484.72731972086|        3869|
|     cadillac|19493.823915525114|        3504|
|        acura|19843.563445101907|        3042|
|     chrysler| 10505.57401912298|        3033|
+-------------+------------------+------------+
only showing top 20 rows

-----------------------------------------------
----------------- Query 2 ---------------------
-----------------------------------------------

What is the average price and sum of listings per state?

+--------------------+------------+------------+
|               state|num_listings|median_price|
+--------------------+------------+------------+
|                 ...|           1|      8991.0|
|                 ...|           1|     23799.0|
|                 ...|           2|     34995.0|
|                 ...|           1|     10987.0|
|                 ...|           1|     25588.0|
|                 ...|           1|     21995.0|
|                 ...|           1|     42908.0|
|                 ...|           1|     41500.0|
|                 ...|           1|      7450.0|
|                 ...|           1|     54500.0|
|                 ...|           1|     12250.0|
|                 ...|           1|      8737.0|
|                 ...|           2|     64995.0|
|                 ...|           7|     27546.0|
|                 ...|           1|     28775.0|
|                 ...|           3|     12995.0|
|                 ...|           1|     23998.0|
|                 ...|           1|         0.0|
|                 ...|           1|     14489.0|
|                 ...|           1|     67500.0|
+--------------------+------------+------------+
only showing top 20 rows

-----------------------------------------------
----------------- Query 3 ---------------------
-----------------------------------------------

What percentage of postings for each state is salvaged cars?

+-----+----------+
|state|percentage|
+-----+----------+
|   ca|     26.15|
|   nc|      6.48|
|   tx|      5.97|
|   sc|      4.87|
|   nm|      4.22|
|   pa|      4.17|
|   mn|      4.12|
|   ia|      3.66|
|   or|      2.81|
|   ny|      2.26|
|   wi|      2.06|
|   az|      1.91|
|   mi|      1.91|
|   oh|      1.76|
|   co|      1.66|
|   id|      1.51|
|   tn|      1.36|
|   wa|      1.26|
|   fl|       1.2|
|   nj|       1.1|
+-----+----------+
only showing top 20 rows

None
-----------------------------------------------
----------------- Results ---------------------
-----------------------------------------------
+--------------------+--------------+------------+------------------+---------+
|   Cores & Instances|   Query/Model|Dataset size|    Execution Time|CPU Usage|
+--------------------+--------------+------------+------------------+---------+
|2 cores & 12 inst...|Sample loading|         700|13.286910057067871|      9.6|
|2 cores & 12 inst...|       Query 1|         700| 3.368847370147705|     14.0|
|2 cores & 12 inst...|       Query 2|         700| 3.756889581680298|     14.8|
|2 cores & 12 inst...|       Query 3|         700| 6.545511960983276|     17.8|
+--------------------+--------------+------------+------------------+---------+



-----------------------------------------------
-------------- Models Testing -----------------
-----------------------------------------------


root
 |-- index: long (nullable = false)
 |-- price: string (nullable = true)
 |-- year: string (nullable = true)
 |-- manufacturer: string (nullable = true)
 |-- model: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- fuel: string (nullable = true)
 |-- odometer: string (nullable = true)
 |-- title_status: string (nullable = true)
 |-- transmission: string (nullable = true)
 |-- type: string (nullable = true)
 |-- posting_date: date (nullable = true)
 |-- age: double (nullable = true)
 |-- row_num: integer (nullable = true)

root
 |-- index: long (nullable = false)
 |-- price: string (nullable = true)
 |-- year: string (nullable = true)
 |-- manufacturer: string (nullable = true)
 |-- model: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- fuel: string (nullable = true)
 |-- odometer: string (nullable = true)
 |-- title_status: string (nullable = true)
 |-- transmission: string (nullable = true)
 |-- type: string (nullable = true)
 |-- age: double (nullable = true)

+-----+-----+----+------------+--------------------+---------+------+--------+------------+------------+-----------+----+
|index|price|year|manufacturer|               model|condition|  fuel|odometer|title_status|transmission|       type| age|
+-----+-----+----+------------+--------------------+---------+------+--------+------------+------------+-----------+----+
|    0| 6299|2008|       honda|              accord|excellent|   gas|  189431|       clean|   automatic|      sedan|13.0|
|    1|22988|2019|        jeep|            cherokee|excellent|   gas|   27325|       clean|   automatic|        SUV| 2.0|
|    2|15995|2015|         kia|              optima|excellent|   gas|   90148|       clean|   automatic|      sedan| 6.0|
|    5|26590|2017|      toyota|rav4 hybrid se sport|     good|hybrid|   42163|       clean|   automatic|        SUV| 4.0|
|    6| 5000|2008|       honda|               civic|     good|   gas|  180000|       clean|   automatic|      sedan|13.0|
|    8| 7600|2008|        mini|      cooper clubman|     good|   gas|   76991|       clean|   automatic|      coupe|13.0|
|    9| 6497|2009|      subaru|forester 2.5i pre...|     good|   gas|  154000|       clean|   automatic|      wagon|12.0|
|   10| 4400|2008|       honda|               civic|excellent|   gas|  113455|       clean|      manual|      coupe|13.0|
|   12|15970|2014|       dodge|          charger se|excellent|   gas|   90776|       clean|   automatic|      other| 7.0|
|   13| 7975|2010|         gmc|          acadia awd|excellent|   gas|  198000|       clean|   automatic|        SUV|11.0|
|   15|30000|2016|       honda|             odyssey| like new|   gas|    9450|     salvage|   automatic|        van| 5.0|
|   16|18999|2015|    cadillac|                 srx|excellent|   gas|   69154|       clean|   automatic|        SUV| 6.0|
|   17|24995|2015|      toyota|          highlander|excellent|   gas|   83169|       clean|   automatic|        SUV| 6.0|
|   18| 9995|2005|        ford| explorer sport trac|excellent|   gas|  166230|       clean|   automatic|     pickup|16.0|
|   20|18188|2017|      nissan|            rogue sv|     good|   gas|   67830|       clean|   automatic|      other| 4.0|
|   21| 4999|2000|       dodge|              dakota|     good|   gas|  194848|       clean|   automatic|      truck|21.0|
|   22| 5400|2004|      toyota|               camry|excellent|   gas|  108000|       clean|   automatic|      sedan|17.0|
|   24| 7999|2004|        audi|        s4 cabriolet|excellent|   gas|   69000|       clean|      manual|convertible|17.0|
|   28|29777|2018|       volvo|           certified|excellent|   gas|   34040|       clean|   automatic|      sedan| 3.0|
|   30|13900|2019|  volkswagen|               jetta|excellent|   gas|   46500|       clean|   automatic|      sedan| 2.0|
+-----+-----+----+------------+--------------------+---------+------+--------+------------+------------+-----------+----+
only showing top 20 rows

Categorical features: ['year', 'manufacturer', 'model', 'condition', 'fuel', 'title_status', 'transmission', 'type']


+-----+--------+----+----+------------+------+---------+----+------------+------------+----+
|price|odometer| age|year|manufacturer| model|condition|fuel|title_status|transmission|type|
+-----+--------+----+----+------------+------+---------+----+------------+------------+----+
| 5900| 86619.0|15.0|12.0|         2.0|   2.0|      0.0| 0.0|         0.0|         0.0| 0.0|
|17936| 58704.0| 4.0| 4.0|         6.0|  13.0|      0.0| 0.0|         0.0|         0.0| 1.0|
|39990|  6500.0| 1.0|18.0|        20.0| 251.0|      1.0| 0.0|         0.0|         0.0|10.0|
| 6500|143297.0|16.0|13.0|        23.0|2430.0|      0.0| 0.0|         0.0|         0.0| 0.0|
|37900|157284.0| 5.0| 6.0|         0.0| 155.0|      2.0| 1.0|         0.0|         0.0| 3.0|
| 3500|176000.0|16.0|13.0|        15.0| 643.0|      1.0| 0.0|         0.0|         0.0| 0.0|
| 2000|144000.0|16.0|13.0|         3.0|  84.0|      1.0| 0.0|         0.0|         0.0| 0.0|
| 7900| 65900.0| 7.0| 1.0|         4.0| 364.0|      2.0| 0.0|         0.0|         0.0| 4.0|
|16000|111000.0| 9.0| 3.0|         9.0|4678.0|      2.0| 0.0|         0.0|         0.0| 5.0|
|25991| 80522.0| 5.0| 6.0|        22.0|  76.0|      0.0| 0.0|         0.0|         0.0| 1.0|
|20995| 92528.0| 4.0| 4.0|         0.0| 686.0|      0.0| 0.0|         0.0|         0.0| 1.0|
|22995| 73049.0|null| 3.0|         0.0|   0.0|      1.0| 0.0|         0.0|         0.0| 2.0|
| 9000|125151.0|10.0| 5.0|        11.0| 575.0|      1.0| 0.0|         0.0|         0.0| 1.0|
|22900|110936.0| 7.0| 1.0|         0.0| 193.0|      0.0| 0.0|         0.0|         0.0| 2.0|
| 9800|122000.0|10.0| 5.0|         5.0| 179.0|      0.0| 0.0|         0.0|         0.0| 0.0|
| 6990|169000.0|13.0| 7.0|         2.0| 188.0|      0.0| 0.0|         0.0|         0.0| 1.0|
| 4590| 78885.0|16.0|13.0|         0.0| 361.0|      1.0| 0.0|         0.0|         0.0| 0.0|
| 8497|128700.0|11.0| 8.0|         0.0|1746.0|      0.0| 0.0|         0.0|         0.0| 1.0|
|10995|119021.0| 9.0| 3.0|         4.0|  27.0|      0.0| 0.0|         0.0|         0.0| 1.0|
|24500|193000.0| 9.0| 3.0|        12.0|  34.0|      1.0| 1.0|         0.0|         0.0| 2.0|
+-----+--------+----+----+------------+------+---------+----+------------+------------+----+
only showing top 20 rows

root
 |-- price: long (nullable = true)
 |-- odometer: double (nullable = true)
 |-- age: double (nullable = true)
 |-- year: double (nullable = false)
 |-- manufacturer: double (nullable = false)
 |-- model: double (nullable = false)
 |-- condition: double (nullable = false)
 |-- fuel: double (nullable = false)
 |-- title_status: double (nullable = false)
 |-- transmission: double (nullable = false)
 |-- type: double (nullable = false)


--- ML dataset ---

+-----+--------------------+
|price|            features|
+-----+--------------------+
| 6299|(10,[0,1,2,3,4],[...|
|22988|[27325.0,2.0,15.0...|
|15995|(10,[0,1,2,3,4],[...|
|26590|[42163.0,4.0,4.0,...|
| 5000|[180000.0,13.0,7....|
+-----+--------------------+
only showing top 5 rows


--- Train Data ---

+-----+--------------------+
|price|            features|
+-----+--------------------+
| 2000|(10,[0,1,2,3,4],[...|
| 2000|(10,[0,1,2,4,9],[...|
| 2000|(10,[0,1,2,5,9],[...|
| 2000|[14517.0,1.0,18.0...|
| 2000|[66000.0,5.0,6.0,...|
+-----+--------------------+
only showing top 5 rows


--- Test Data ---

+-----+--------------------+
|price|            features|
+-----+--------------------+
| 2000|(10,[0,1,2,3,4],[...|
| 2000|(10,[0,1,2,4,5],[...|
| 2000|[64000.0,17.0,14....|
| 2000|[141936.0,9.0,3.0...|
| 2000|[144000.0,16.0,13...|
+-----+--------------------+
only showing top 5 rows


--- Data Used for the Prediction---

+-----+--------------------+
|price|            features|
+-----+--------------------+
| 2950|(10,[0,1,2,3,4],[...|
| 3200|(10,[0,1,2,3,4],[...|
| 3495|(10,[0,1,2,3,4],[...|
| 3595|[153177.0,18.0,16...|
| 3950|(10,[0,1,2,4,5],[...|
+-----+--------------------+
only showing top 5 rows

-----------------------------------------------
-------------- Linear Regression --------------
-----------------------------------------------
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Step Size: 0.1229
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.419680 (rel: 0.161) 0.676427
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Step Size: 0.5000
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.311936 (rel: 0.257) 0.342125
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Step Size: 0.5000
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.281745 (rel: 0.0968) 0.167472
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.271210 (rel: 0.0374) 0.0853659
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.268112 (rel: 0.0114) 0.0515686
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.265338 (rel: 0.0103) 0.0232938
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.264731 (rel: 0.00229) 0.0119301
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.264716 (rel: 5.50e-05) 0.0165444
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.264633 (rel: 0.000314) 0.000733057
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.264633 (rel: 8.72e-07) 0.000272683
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.264633 (rel: 1.50e-07) 3.87413e-05
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.264633 (rel: 2.34e-09) 9.51818e-06
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.264633 (rel: 1.18e-10) 1.42005e-06
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.264633 (rel: 3.31e-12) 2.82505e-07
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.264633 (rel: 1.54e-13) 8.92937e-08
23/05/03 22:09:23 INFO breeze.optimize.OWLQN: Converged because gradient converged

	--- Coefficient of Determination (R² & Adjusted R²) ---
R²		: 0.47077
Adjusted R²	: 0.47077

	--- Mean Squared Error (MSE & RMSE) ---
MSE	: 55586221.2036
RMSE	: 7455.62

	--- Mean Absolute Error (MAE) ---
MAE	: 5593.42

	--- Predictions ---
+-----+--------------------+------------------+
|price|            features|        prediction|
+-----+--------------------+------------------+
| 2950|(10,[0,1,2,3,4],[...|3880.2679625806777|
| 3200|(10,[0,1,2,3,4],[...| 5544.403396537673|
| 3495|(10,[0,1,2,3,4],[...| 8427.048567365633|
| 3595|[153177.0,18.0,16...|2786.5597733399118|
| 3950|(10,[0,1,2,4,5],[...| 7661.140904629778|
+-----+--------------------+------------------+
only showing top 5 rows

-----------------------------------------------
---------------- Decision Tree ----------------
-----------------------------------------------

	--- Coefficient of Determination (R² & Adjusted R²) ---
R²		: -0.02513
Adjusted R²	: -0.02513

	--- Mean Squared Error (MSE & RMSE) ---
MSE	: 107670783.0414
RMSE	: 10376.45

	--- Mean Absolute Error (MAE) ---
MAE	: 5449.26

	--- Predictions ---
+-----+--------------------+-----------------+
|price|            features|       prediction|
+-----+--------------------+-----------------+
| 2950|(10,[0,1,2,3,4],[...|4712.328976404685|
| 3200|(10,[0,1,2,3,4],[...|4712.328976404685|
| 3495|(10,[0,1,2,3,4],[...|4712.328976404685|
| 3595|[153177.0,18.0,16...|4712.328976404685|
| 3950|(10,[0,1,2,4,5],[...|7197.296201945345|
+-----+--------------------+-----------------+
only showing top 5 rows

-----------------------------------------------
--------- Random Forest Regression ------------
-----------------------------------------------

	--- Coefficient of Determination (R² & Adjusted R²) ---
R²		: 0.55256
Adjusted R²	: 0.55256

	--- Mean Squared Error (MSE & RMSE) ---
MSE	: 46995059.1762
RMSE	: 6855.29

	--- Mean Absolute Error (MAE) ---
MAE	: 5157.47

	--- Predictions ---
+-----+--------------------+----------------+
|price|            features|      prediction|
+-----+--------------------+----------------+
| 2950|(10,[0,1,2,3,4],[...|8510.71061894206|
| 3200|(10,[0,1,2,3,4],[...|8510.71061894206|
| 3495|(10,[0,1,2,3,4],[...|8510.71061894206|
| 3595|[153177.0,18.0,16...|8510.71061894206|
| 3950|(10,[0,1,2,4,5],[...|8510.71061894206|
+-----+--------------------+----------------+
only showing top 5 rows

-----------------------------------------------
----------------- Results ---------------------
-----------------------------------------------
+--------------------+--------------------+------------+------------------+---------+
|   Cores & Instances|         Query/Model|Dataset size|    Execution Time|CPU Usage|
+--------------------+--------------------+------------+------------------+---------+
|2 cores & 12 inst...|    Liner Regression|         700|36.209970474243164|     14.7|
|2 cores & 12 inst...|       Decision Tree|         700| 26.94177222251892|     15.3|
|2 cores & 12 inst...|Random Forest Reg...|         700|24.869142293930054|     14.2|
+--------------------+--------------------+------------+------------------+---------+



-----------------------------------------------
----------- Sample size: 1.3 GB ---------------
-----------------------------------------------


+----------+--------------------+--------------------+--------------------+-----+----+------------+-----+---------+---------+----+--------+------------+------------+----+-----+----+----+-----------+---------+-----------+------+-----+----+----+------------+
|        id|                 url|              region|          region_url|price|year|manufacturer|model|condition|cylinders|fuel|odometer|title_status|transmission| VIN|drive|size|type|paint_color|image_url|description|county|state| lat|long|posting_date|
+----------+--------------------+--------------------+--------------------+-----+----+------------+-----+---------+---------+----+--------+------------+------------+----+-----+----+----+-----------+---------+-----------+------+-----+----+----+------------+
|7222695916|https://prescott....|            prescott|https://prescott....| 6000|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   az|null|null|        null|
|7218891961|https://fayar.cra...|        fayetteville|https://fayar.cra...|11900|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   ar|null|null|        null|
|7221797935|https://keys.crai...|        florida keys|https://keys.crai...|21000|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   fl|null|null|        null|
|7222270760|https://worcester...|worcester / centr...|https://worcester...| 1500|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   ma|null|null|        null|
|7210384030|https://greensbor...|          greensboro|https://greensbor...| 4900|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   nc|null|null|        null|
|7222379453|https://hudsonval...|       hudson valley|https://hudsonval...| 1600|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   ny|null|null|        null|
|7221952215|https://hudsonval...|       hudson valley|https://hudsonval...| 1000|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   ny|null|null|        null|
|7220195662|https://hudsonval...|       hudson valley|https://hudsonval...|15995|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   ny|null|null|        null|
|7209064557|https://medford.c...|     medford-ashland|https://medford.c...| 5000|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   or|null|null|        null|
|7219485069|https://erie.crai...|                erie|https://erie.crai...| 3000|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   pa|null|null|        null|
|7218893038|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   tx|null|null|        null|
|7218325704|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   tx|null|null|        null|
|7217788283|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   tx|null|null|        null|
|7217147606|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   tx|null|null|        null|
|7209027818|https://elpaso.cr...|             el paso|https://elpaso.cr...|    0|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   tx|null|null|        null|
|7223509794|https://bellingha...|          bellingham|https://bellingha...|13995|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   wa|null|null|        null|
|7222753076|https://bellingha...|          bellingham|https://bellingha...|24999|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   wa|null|null|        null|
|7222206015|https://bellingha...|          bellingham|https://bellingha...|21850|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   wa|null|null|        null|
|7220030122|https://bellingha...|          bellingham|https://bellingha...|26850|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   wa|null|null|        null|
|7218423006|https://bellingha...|          bellingham|https://bellingha...|11999|null|        null| null|     null|     null|null|    null|        null|        null|null| null|null|null|       null|     null|       null|  null|   wa|null|null|        null|
+----------+--------------------+--------------------+--------------------+-----+----+------------+-----+---------+---------+----+--------+------------+------------+----+-----+----+----+-----------+---------+-----------+------+-----+----+----+------------+
only showing top 20 rows



-----------------------------------------------
------------- Queries Testing -----------------
-----------------------------------------------


-----------------------------------------------
----------------- Query 1 ---------------------
-----------------------------------------------

What's the average price and total number of listings for each car manufacturer?

+-------------+------------------+------------+
| manufacturer|        avg(price)|num_listings|
+-------------+------------------+------------+
|         ford|36411.718024934846|       70985|
|    chevrolet|115676.10164535813|       55064|
|       toyota|234294.68262089937|       34202|
|        honda|  10751.3637218487|       21269|
|       nissan| 18827.33282634919|       19067|
|         jeep| 150717.8196591985|       19014|
|          ram|27728.339166939266|       18342|
|          gmc|30405.877152219244|       16785|
|          bmw|26740.261446356893|       14699|
|        dodge|15003.200554461224|       13707|
|mercedes-benz| 531710.5573326563|       11817|
|      hyundai|10719.659411878507|       10338|
|       subaru|13055.512585571354|        9495|
|   volkswagen|  12537.0987693954|        9345|
|          kia|11083.324819676009|        8457|
|        lexus| 19206.15268292683|        8200|
|         audi|23574.849993397598|        7573|
|     cadillac|  19439.5209262189|        6953|
|     chrysler|10442.946609185872|        6031|
|        acura|19842.869521579123|        5978|
+-------------+------------------+------------+
only showing top 20 rows

-----------------------------------------------
----------------- Query 2 ---------------------
-----------------------------------------------

What is the average price and sum of listings per state?

+--------------------+------------+------------+
|               state|num_listings|median_price|
+--------------------+------------+------------+
|                 ...|           1|      8991.0|
|                 ...|           1|     23799.0|
|                 ...|           1|         0.0|
|                 ...|           2|     34995.0|
|                 ...|           1|     10987.0|
|                 ...|           1|     21675.0|
|                 ...|           1|     30987.0|
|                 ...|           1|     25588.0|
|                 ...|           1|     19900.0|
|                 ...|           1|     16096.0|
|                 ...|           1|     21995.0|
|                 ...|           2|     42908.0|
|                 ...|           1|     41500.0|
|                 ...|           1|      7450.0|
|                 ...|           1|     27900.0|
|                 ...|           1|     54500.0|
|                 ...|           1|     12250.0|
|                 ...|           1|      8737.0|
|                 ...|           6|     68995.0|
|                 ...|           7|     27546.0|
+--------------------+------------+------------+
only showing top 20 rows

-----------------------------------------------
----------------- Query 3 ---------------------
-----------------------------------------------

What percentage of postings for each state is salvaged cars?

+-----+----------+
|state|percentage|
+-----+----------+
|   ca|      25.8|
|   nc|      7.01|
|   tx|      6.31|
|   sc|      4.94|
|   ia|      4.14|
|   pa|      3.93|
|   nm|      3.85|
|   mn|       3.7|
|   or|       3.0|
|   mi|      2.09|
|   az|      1.94|
|   ny|      1.89|
|   oh|      1.86|
|   wi|      1.81|
|   co|      1.58|
|   id|       1.5|
|   tn|      1.37|
|   sd|      1.34|
|   fl|      1.34|
|   nj|      1.29|
+-----+----------+
only showing top 20 rows

None
-----------------------------------------------
----------------- Results ---------------------
-----------------------------------------------
+--------------------+--------------+------------+-----------------+---------+
|   Cores & Instances|   Query/Model|Dataset size|   Execution Time|CPU Usage|
+--------------------+--------------+------------+-----------------+---------+
|2 cores & 12 inst...|Sample loading|        1300|29.00465154647827|     12.5|
|2 cores & 12 inst...|       Query 1|        1300|3.274095058441162|      9.4|
|2 cores & 12 inst...|       Query 2|        1300|3.647270679473877|     10.7|
|2 cores & 12 inst...|       Query 3|        1300|7.795445203781128|      8.8|
+--------------------+--------------+------------+-----------------+---------+



-----------------------------------------------
-------------- Models Testing -----------------
-----------------------------------------------


root
 |-- index: long (nullable = false)
 |-- price: string (nullable = true)
 |-- year: string (nullable = true)
 |-- manufacturer: string (nullable = true)
 |-- model: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- fuel: string (nullable = true)
 |-- odometer: string (nullable = true)
 |-- title_status: string (nullable = true)
 |-- transmission: string (nullable = true)
 |-- type: string (nullable = true)
 |-- posting_date: date (nullable = true)
 |-- age: double (nullable = true)
 |-- row_num: integer (nullable = true)

root
 |-- index: long (nullable = false)
 |-- price: string (nullable = true)
 |-- year: string (nullable = true)
 |-- manufacturer: string (nullable = true)
 |-- model: string (nullable = true)
 |-- condition: string (nullable = true)
 |-- fuel: string (nullable = true)
 |-- odometer: string (nullable = true)
 |-- title_status: string (nullable = true)
 |-- transmission: string (nullable = true)
 |-- type: string (nullable = true)
 |-- age: double (nullable = true)

+-----+-----+----+-------------+--------------------+---------+------+--------+------------+------------+-----------+----+
|index|price|year| manufacturer|               model|condition|  fuel|odometer|title_status|transmission|       type| age|
+-----+-----+----+-------------+--------------------+---------+------+--------+------------+------------+-----------+----+
|    1| 5900|2006|       toyota|               camry|excellent|   gas|   86619|       clean|   automatic|      sedan|15.0|
|    7|17936|2017|         jeep|      grand cherokee|excellent|   gas|   58704|       clean|   automatic|        SUV| 4.0|
|    9|11000|2008|       toyota|              tundra|     good|   gas|  195000|       clean|   automatic|     pickup|13.0|
|   10|39990|2020|     infiniti|qx60 luxe sport u...|     good|   gas|    6500|       clean|   automatic|      other| 1.0|
|   11|45200|2017|          bmw|          640i coupe| like new|   gas|   35109|       clean|   automatic|convertible| 4.0|
|   16|47777|2015|       jaguar|               ftype|excellent|   gas|   30000|       clean|   automatic|      coupe| 6.0|
|   18|12999|2011|    chevrolet|silverado 1500 lt...| like new|   gas|  123456|       clean|   automatic|      truck|10.0|
|   20| 3400|2001|         ford|               e-150|     fair|   gas|  150000|       clean|   automatic|   mini-van|20.0|
|   21| 6500|2005|      lincoln|             towncar|excellent|   gas|  143297|       clean|   automatic|      sedan|16.0|
|   23|37900|2016|         ford|     f350 super duty| like new|diesel|  157284|       clean|   automatic|     pickup| 5.0|
|   29|36990|2014|         ford|    f-550 super duty|excellent|diesel|  142199|       clean|   automatic|      truck|null|
|   33| 7499|2012|        mazda|                   6|excellent|   gas|  125200|       clean|   automatic|      sedan| 9.0|
|   35| 3800|2008|       nissan|              sentra|     fair|   gas|   80542|       clean|   automatic|      sedan|13.0|
|   38|20000|2018|         mini|      cooper hardtop|excellent|   gas|   17999|       clean|   automatic|      sedan| 3.0|
|   39| 3500|2005|        lexus|              es 300|     good|   gas|  176000|       clean|   automatic|      sedan|16.0|
|   40| 2000|2005|        honda|            civic lx|     good|   gas|  144000|       clean|   automatic|      sedan|16.0|
|   43| 7900|2014|       nissan|          versa note| like new|   gas|   65900|       clean|   automatic|  hatchback| 7.0|
|   44|16000|2012|mercedes-benz|               e-550| like new|   gas|  111000|       clean|   automatic|      coupe| 9.0|
|   46|33888|2013|       toyota|          tacoma 4x4| like new|   gas|   67915|       clean|   automatic|      truck| 8.0|
|   47|25991|2016|        acura|                 mdx|excellent|   gas|   80522|       clean|   automatic|        SUV| 5.0|
+-----+-----+----+-------------+--------------------+---------+------+--------+------------+------------+-----------+----+
only showing top 20 rows

Categorical features: ['year', 'manufacturer', 'model', 'condition', 'fuel', 'title_status', 'transmission', 'type']


+-----+--------+----+----+------------+------+---------+----+------------+------------+----+
|price|odometer| age|year|manufacturer| model|condition|fuel|title_status|transmission|type|
+-----+--------+----+----+------------+------+---------+----+------------+------------+----+
| 5900| 86619.0|15.0|12.0|         2.0|   2.0|      0.0| 0.0|         0.0|         0.0| 0.0|
|17936| 58704.0| 4.0| 5.0|         6.0|  16.0|      0.0| 0.0|         0.0|         0.0| 1.0|
|11000|195000.0|13.0| 7.0|         2.0|  42.0|      1.0| 0.0|         0.0|         0.0| 3.0|
|39990|  6500.0| 1.0|18.0|        20.0| 255.0|      1.0| 0.0|         0.0|         0.0|10.0|
|45200| 35109.0| 4.0| 5.0|         5.0|3099.0|      2.0| 0.0|         0.0|         0.0| 8.0|
|47777| 30000.0| 6.0| 3.0|        31.0|7458.0|      0.0| 0.0|         0.0|         0.0| 5.0|
|12999|123456.0|10.0| 4.0|         1.0| 317.0|      2.0| 0.0|         0.0|         0.0| 2.0|
| 3400|150000.0|20.0|19.0|         0.0|1240.0|      3.0| 0.0|         0.0|         0.0| 7.0|
| 6500|143297.0|16.0|13.0|        23.0|2981.0|      0.0| 0.0|         0.0|         0.0| 0.0|
|37900|157284.0| 5.0| 6.0|         0.0| 166.0|      2.0| 1.0|         0.0|         0.0| 3.0|
|36990|142199.0|null| 1.0|         0.0|1064.0|      0.0| 1.0|         0.0|         0.0| 2.0|
| 7499|125200.0| 9.0| 2.0|        18.0| 193.0|      0.0| 0.0|         0.0|         0.0| 0.0|
| 3800| 80542.0|13.0| 7.0|         4.0|  31.0|      3.0| 0.0|         0.0|         0.0| 0.0|
|20000| 17999.0| 3.0| 9.0|        26.0| 241.0|      0.0| 0.0|         0.0|         0.0| 0.0|
| 3500|176000.0|16.0|13.0|        15.0| 576.0|      1.0| 0.0|         0.0|         0.0| 0.0|
| 2000|144000.0|16.0|13.0|         3.0|  71.0|      1.0| 0.0|         0.0|         0.0| 0.0|
| 7900| 65900.0| 7.0| 1.0|         4.0| 385.0|      2.0| 0.0|         0.0|         0.0| 4.0|
|16000|111000.0| 9.0| 2.0|        10.0|6685.0|      2.0| 0.0|         0.0|         0.0| 5.0|
|33888| 67915.0| 8.0| 0.0|         2.0| 430.0|      2.0| 0.0|         0.0|         0.0| 2.0|
|25991| 80522.0| 5.0| 6.0|        21.0|  79.0|      0.0| 0.0|         0.0|         0.0| 1.0|
+-----+--------+----+----+------------+------+---------+----+------------+------------+----+
only showing top 20 rows

root
 |-- price: long (nullable = true)
 |-- odometer: double (nullable = true)
 |-- age: double (nullable = true)
 |-- year: double (nullable = false)
 |-- manufacturer: double (nullable = false)
 |-- model: double (nullable = false)
 |-- condition: double (nullable = false)
 |-- fuel: double (nullable = false)
 |-- title_status: double (nullable = false)
 |-- transmission: double (nullable = false)
 |-- type: double (nullable = false)


--- ML dataset ---

+-----+--------------------+
|price|            features|
+-----+--------------------+
|19500|(10,[0,1,2,3,4],[...|
| 7500|[106000.0,12.0,11...|
| 6249|[64754.0,7.0,1.0,...|
|14750|[88200.0,10.0,4.0...|
|10500|[101028.0,8.0,0.0...|
+-----+--------------------+
only showing top 5 rows


--- Train Data ---

+-----+--------------------+
|price|            features|
+-----+--------------------+
| 2000|(10,[0,1,2,3,4],[...|
| 2000|(10,[0,1,2,4,5],[...|
| 2000|(10,[0,1,2,4,5],[...|
| 2000|(10,[0,1,2,4,9],[...|
| 2000|(10,[0,1,2,5,9],[...|
+-----+--------------------+
only showing top 5 rows


--- Test Data ---

+-----+--------------------+
|price|            features|
+-----+--------------------+
| 2000|(10,[0,1,2,3,4],[...|
| 2000|(10,[0,1,2,4,5],[...|
| 2000|[60000.0,16.0,13....|
| 2000|[111000.0,15.0,12...|
| 2000|[120000.0,21.0,20...|
+-----+--------------------+
only showing top 5 rows


--- Data Used for the Prediction---

+-----+--------------------+
|price|            features|
+-----+--------------------+
| 2500|[167000.0,14.0,10...|
| 2900|(10,[0,1,2,4,5],[...|
| 2995|(10,[0,1,2,4,5],[...|
| 3000|[145000.0,14.0,10...|
| 3300|[187429.0,11.0,8....|
+-----+--------------------+
only showing top 5 rows

-----------------------------------------------
-------------- Linear Regression --------------
-----------------------------------------------
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Step Size: 0.1243
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.420564 (rel: 0.159) 0.669449
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Step Size: 0.5000
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.313417 (rel: 0.255) 0.336009
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Step Size: 0.5000
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.283473 (rel: 0.0955) 0.169500
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.270446 (rel: 0.0460) 0.0496517
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.268895 (rel: 0.00573) 0.0378896
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.266955 (rel: 0.00721) 0.0131561
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Step Size: 0.5000
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.266922 (rel: 0.000124) 0.00686888
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.266902 (rel: 7.54e-05) 0.00102739
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.266902 (rel: 1.86e-06) 0.000114867
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.266902 (rel: 2.76e-08) 2.50939e-05
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.266902 (rel: 1.26e-09) 1.71100e-06
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.266902 (rel: 4.27e-12) 2.95545e-07
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Step Size: 1.000
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Val and Grad Norm: 0.266902 (rel: 1.37e-13) 2.88509e-08
23/05/03 22:12:00 INFO breeze.optimize.OWLQN: Converged because gradient converged

	--- Coefficient of Determination (R² & Adjusted R²) ---
R²		: 0.46980
Adjusted R²	: 0.46980

	--- Mean Squared Error (MSE & RMSE) ---
MSE	: 55940992.6305
RMSE	: 7479.37

	--- Mean Absolute Error (MAE) ---
MAE	: 5631.85

	--- Predictions ---
+-----+--------------------+------------------+
|price|            features|        prediction|
+-----+--------------------+------------------+
| 2500|[167000.0,14.0,10...| 4771.413599528951|
| 2900|(10,[0,1,2,4,5],[...| 7184.737020049248|
| 2995|(10,[0,1,2,4,5],[...| 4683.969571333804|
| 3000|[145000.0,14.0,10...|  9130.96973750004|
| 3300|[187429.0,11.0,8....|7303.0594207585855|
+-----+--------------------+------------------+
only showing top 5 rows

-----------------------------------------------
---------------- Decision Tree ----------------
-----------------------------------------------
23/05/03 22:12:35 WARN org.apache.spark.scheduler.DAGScheduler: Broadcasting large task binary with size 1024.1 KiB

	--- Coefficient of Determination (R² & Adjusted R²) ---
R²		: 0.24898
Adjusted R²	: 0.24898

	--- Mean Squared Error (MSE & RMSE) ---
MSE	: 79239996.7269
RMSE	: 8901.69

	--- Mean Absolute Error (MAE) ---
MAE	: 4631.70

	--- Predictions ---
+-----+--------------------+----------------+
|price|            features|      prediction|
+-----+--------------------+----------------+
| 2500|[167000.0,14.0,10...|4801.45823646629|
| 2900|(10,[0,1,2,4,5],[...|4801.45823646629|
| 2995|(10,[0,1,2,4,5],[...|4801.45823646629|
| 3000|[145000.0,14.0,10...|4801.45823646629|
| 3300|[187429.0,11.0,8....|7346.56821148825|
+-----+--------------------+----------------+
only showing top 5 rows

-----------------------------------------------
--------- Random Forest Regression ------------
-----------------------------------------------

	--- Coefficient of Determination (R² & Adjusted R²) ---
R²		: 0.56231
Adjusted R²	: 0.56231

	--- Mean Squared Error (MSE & RMSE) ---
MSE	: 46180808.9938
RMSE	: 6795.65

	--- Mean Absolute Error (MAE) ---
MAE	: 5151.72

	--- Predictions ---
+-----+--------------------+-----------------+
|price|            features|       prediction|
+-----+--------------------+-----------------+
| 2500|[167000.0,14.0,10...|9064.826816929515|
| 2900|(10,[0,1,2,4,5],[...|9064.826816929515|
| 2995|(10,[0,1,2,4,5],[...|9064.826816929515|
| 3000|[145000.0,14.0,10...|9064.826816929515|
| 3300|[187429.0,11.0,8....|9064.826816929515|
+-----+--------------------+-----------------+
only showing top 5 rows

-----------------------------------------------
----------------- Results ---------------------
-----------------------------------------------
+--------------------+--------------------+------------+------------------+---------+
|   Cores & Instances|         Query/Model|Dataset size|    Execution Time|CPU Usage|
+--------------------+--------------------+------------+------------------+---------+
|2 cores & 12 inst...|    Liner Regression|        1300| 35.02082920074463|     13.0|
|2 cores & 12 inst...|       Decision Tree|        1300| 28.56442093849182|     12.6|
|2 cores & 12 inst...|Random Forest Reg...|        1300|26.665043354034424|     14.5|
+--------------------+--------------------+------------+------------------+---------+


-----------------------------------------------
--------------- All Results -------------------
-----------------------------------------------

+--------------------+--------------------+------------+------------------+---------+
|   Cores & Instances|         Query/Model|Dataset size|    Execution Time|CPU Usage|
+--------------------+--------------------+------------+------------------+---------+
|2 cores & 12 inst...|      Sample loading|         100| 16.11558222770691|     32.7|
|2 cores & 12 inst...|             Query 1|         100| 6.961515188217163|     36.8|
|2 cores & 12 inst...|             Query 2|         100| 5.472331285476685|     33.0|
|2 cores & 12 inst...|             Query 3|         100| 7.817259073257446|     35.0|
|2 cores & 12 inst...|    Liner Regression|         100|37.280999183654785|     25.8|
|2 cores & 12 inst...|        Decison Tree|         100| 27.87275004386902|     20.7|
|2 cores & 12 inst...|Random Forest Reg...|         100|24.740081787109375|     17.1|
|2 cores & 12 inst...|      Sample loading|         700|13.286910057067871|      9.6|
|2 cores & 12 inst...|             Query 1|         700| 3.368847370147705|     14.0|
|2 cores & 12 inst...|             Query 2|         700| 3.756889581680298|     14.8|
|2 cores & 12 inst...|             Query 3|         700| 6.545511960983276|     17.8|
|2 cores & 12 inst...|    Liner Regression|         700|36.209970474243164|     14.7|
|2 cores & 12 inst...|       Decision Tree|         700| 26.94177222251892|     15.3|
|2 cores & 12 inst...|Random Forest Reg...|         700|24.869142293930054|     14.2|
|2 cores & 12 inst...|      Sample loading|        1300| 29.00465154647827|     12.5|
|2 cores & 12 inst...|             Query 1|        1300| 3.274095058441162|      9.4|
|2 cores & 12 inst...|             Query 2|        1300| 3.647270679473877|     10.7|
|2 cores & 12 inst...|             Query 3|        1300| 7.795445203781128|      8.8|
|2 cores & 12 inst...|    Liner Regression|        1300| 35.02082920074463|     13.0|
|2 cores & 12 inst...|       Decision Tree|        1300| 28.56442093849182|     12.6|
+--------------------+--------------------+------------+------------------+---------+
only showing top 20 rows

23/05/03 22:13:27 INFO com.google.cloud.hadoop.repackaged.gcs.com.google.cloud.hadoop.gcsio.GoogleCloudStorageFileSystem: Successfully repaired 'gs://egd-project-final/csv/' directory.
23/05/03 22:13:28 INFO org.sparkproject.jetty.server.AbstractConnector: Stopped Spark@4bdae800{HTTP/1.1, (http/1.1)}{0.0.0.0:0}
